<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>RPG Maker on erri120's very random Blog</title><link>https://erri120.github.io/tags/rpg-maker/</link><description>Recent content in RPG Maker on erri120's very random Blog</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><copyright>CC BY 4.0</copyright><lastBuildDate>Thu, 18 Nov 2021 12:18:00 +0100</lastBuildDate><atom:link href="https://erri120.github.io/tags/rpg-maker/index.xml" rel="self" type="application/rss+xml"/><item><title>Reworking rpgmpacker: Moving from C++ to TypeScript</title><link>https://erri120.github.io/posts/2021-11-18/</link><pubDate>Thu, 18 Nov 2021 12:18:00 +0100</pubDate><guid>https://erri120.github.io/posts/2021-11-18/</guid><description>rpgmpacker has been one of my biggest non-modding related projects on GitHub and the only reason people visit my blog:
The developer of the game Star Knightess Aura (NSFW) is the first actual user of this tool and contributed a good amount of issues on GitHub driving the development of this project forward.
With some issues still open I stopped working on this project in April 2021 because I knew I had to rework this tool at some point and didn&amp;rsquo;t had the motivation to do so at that time.</description><content>&lt;p>&lt;a href="https://github.com/erri120/rpgmpacker">rpgmpacker&lt;/a> has been one of my biggest non-modding related projects on GitHub and the only reason people visit my blog:&lt;/p>
&lt;img src="https://erri120.github.io/img/posts/2021-11-18/Blog-Performance.png" alt="Top queries of my blog" class="left" />
&lt;p>The developer of the game &lt;a href="https://aura-dev.itch.io/star-knightess-aura">Star Knightess Aura (NSFW)&lt;/a> is the first actual user of this tool and contributed a good amount of &lt;a href="https://github.com/erri120/rpgmpacker/issues?q=is%3Aissue+author%3Aauragamedev">issues&lt;/a> on GitHub driving the development of this project forward.&lt;/p>
&lt;p>With some issues still open I stopped working on this project in April 2021 because I knew I had to rework this tool at some point and didn&amp;rsquo;t had the motivation to do so at that time. I used C++ for 1.x because I wanted to finally build something with this language. I had only done small assignments in Uni with C++ but never done anything more with it, mainly because the language sucks ass.&lt;/p>
&lt;p>C/C++ is old, very old and it clearly shows, not just in the language but the tooling available. Ask 20 C++ developers what build system they use and you will likely get 10 different answers. Working with dependencies is a nightmare when it comes to C/C++ development. It&amp;rsquo;s actually impossible to count the amount of times I wanted to contribute to a C++ project only to be blocked by some weird build system that only work in a specific environment when the stars align and the moon is in the Waxing Gibbous lunar phase. Once you did get something to work you now have to deal with the language itself. Let me ask you this: how do you represent a string in C++? Did you know that there is &lt;code>std::string&lt;/code> which is actually just &lt;code>std::basic_string&amp;lt;char&amp;gt;&lt;/code>, &lt;code>std::u16string&lt;/code> which is &lt;code>std::basic_string&amp;lt;char16_t&amp;gt;&lt;/code>, &lt;code>std::u32string&lt;/code> which is &lt;code>std::basic_string&amp;lt;char32_t&amp;gt;&lt;/code> and &lt;code>std::wstring&lt;/code> which is &lt;code>std::basic_string&amp;lt;wchar_t&amp;gt;&lt;/code> but don&amp;rsquo;t let that fool you because there is also &lt;code>char8_t&lt;/code> from C++ 20 that introduces &lt;code>std::u8string&lt;/code> and don&amp;rsquo;t forget that &lt;code>wchar_t&lt;/code> has different sizes depending on the platform, compiler and time of day.&lt;/p>
&lt;p>C++ is a fucking mess. Working with strings in C++ should not be this hard.&lt;/p>
&lt;p>So lets calm down and look at something different: Rust. I love Rust, it&amp;rsquo;s C++ in way better and more modern. I wanted to rework rpgmpacker in Rust and actually did exactly that for quite some time but soon realized this was also not the way.&lt;/p>
&lt;p>RPG Maker MV/MZ is pure JavaScript with the data files being in JSON. The developers are probably familiar with JavaScript as well so in this ecosystem it is more fitting to create a JavaScript tool. Of course I wouldn&amp;rsquo;t be doing that, fuck vanilla JavaScript, I&amp;rsquo;m using TypeScript.&lt;/p>
&lt;p>I like to use the right tool for the job. Even though I&amp;rsquo;m quite the C# fanatic I went with TypeScript because it makes life very easy. I don&amp;rsquo;t have to write complex JSON parsers or DTOs, I can just do &lt;code>JSON.parse(...)&lt;/code> and access whatever I want. One huge problem was also parsing the plugins for the exclude-unused feature. If you open &lt;code>js/plugins.js&lt;/code> in your game, you will find a variable &lt;code>$plugins&lt;/code>. With TypeScript I can just use the VM to dynamically load this file and access this variable directly. With any other language I would have to read the file as a string and do some complex string parsing.&lt;/p>
&lt;p>Of course there are some problems with TypeScript. I previously complained about the C++ dependency systems but the huge dependency trees you can get when using NPM are also insane. Before I even started on the rework I set my goal to require the least amount of modules which ended up being only 1: &lt;a href="https://www.npmjs.com/package/yargs">yargs&lt;/a> because parsing arguments is not something I wanna implement myself.&lt;/p>
&lt;p>I hope the rework will be received pleasantly by the 3 people using the tool.&lt;/p></content></item><item><title>Don't count frames to calculate time</title><link>https://erri120.github.io/posts/2021-09-29/</link><pubDate>Wed, 29 Sep 2021 16:21:15 +0100</pubDate><guid>https://erri120.github.io/posts/2021-09-29/</guid><description>Time and Frames We have all heard the term FPS, frames per second, which tells us how many frames are rendered on screen within one second. Higher FPS will result in smoother animations because those animations get more frames. The problem with high FPS is that the GPU has to keep up with this demand and be able to produce 30/60/144 or more frames within 1 second. This is where frame times, VSync and a bunch of offer stuff that I won&amp;rsquo;t cover here comes into play.</description><content>&lt;h2 id="time-and-frames">Time and Frames&lt;/h2>
&lt;p>We have all heard the term FPS, frames per second, which tells us how many frames are rendered on screen within one second. Higher FPS will result in smoother animations because those animations get more frames. The problem with high FPS is that the GPU has to keep up with this demand and be able to produce 30/60/144 or more frames within 1 second. This is where frame times, VSync and a bunch of offer stuff that I won&amp;rsquo;t cover here comes into play.&lt;/p>
&lt;p>The important takeaway is that you can not reliably calculate a duration based on how many frames where rendered because not every frame takes the same amount of time. This is a problem when you want to eg smoothly move an object from one position to another. Engines like Unity solve this by providing a delta time &lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup> which is the interval from the last to the current frame so you can have smooth translations.&lt;/p>
&lt;h2 id="looking-at-rpg-maker-mvmz">Looking at RPG Maker MV/MZ&lt;/h2>
&lt;p>So what issue does RPG Maker have? I have recently played a game for around 21 hours but the save menu displayed over 51 hours, more than double. Actually not just more than double but around 2.4 times more than expected. This quickly made me realize that I had been playing the game on my 144Hz monitor meaning instead of rendering at 60 FPS, the game was rendering at 144 FPS. I hope you notice that &lt;code>60 x 2.4&lt;/code> equals &lt;code>144&lt;/code>.&lt;/p>
&lt;p>To further investigate the problem I took a peek inside the &lt;code>js&lt;/code> folder, did a quick search for &amp;ldquo;playtime&amp;rdquo; and found the culprits of my frustration:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-javascript" data-lang="javascript">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">Game_System&lt;/span>.&lt;span style="color:#a6e22e">prototype&lt;/span>.&lt;span style="color:#a6e22e">onBeforeSave&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">function&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">this&lt;/span>.&lt;span style="color:#a6e22e">_framesOnSave&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">Graphics&lt;/span>.&lt;span style="color:#a6e22e">frameCount&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// ...
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>};
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-javascript" data-lang="javascript">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">Game_System&lt;/span>.&lt;span style="color:#a6e22e">prototype&lt;/span>.&lt;span style="color:#a6e22e">onAfterLoad&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">function&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">Graphics&lt;/span>.&lt;span style="color:#a6e22e">frameCount&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">this&lt;/span>.&lt;span style="color:#a6e22e">_framesOnSave&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// ...
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>};
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-javascript" data-lang="javascript">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">Game_System&lt;/span>.&lt;span style="color:#a6e22e">prototype&lt;/span>.&lt;span style="color:#a6e22e">playtime&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">function&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> Math.&lt;span style="color:#a6e22e">floor&lt;/span>(&lt;span style="color:#a6e22e">Graphics&lt;/span>.&lt;span style="color:#a6e22e">frameCount&lt;/span> &lt;span style="color:#f92672">/&lt;/span> &lt;span style="color:#ae81ff">60&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-javascript" data-lang="javascript">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">Game_System&lt;/span>.&lt;span style="color:#a6e22e">prototype&lt;/span>.&lt;span style="color:#a6e22e">playtimeText&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">function&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">var&lt;/span> &lt;span style="color:#a6e22e">hour&lt;/span> &lt;span style="color:#f92672">=&lt;/span> Math.&lt;span style="color:#a6e22e">floor&lt;/span>(&lt;span style="color:#66d9ef">this&lt;/span>.&lt;span style="color:#a6e22e">playtime&lt;/span>() &lt;span style="color:#f92672">/&lt;/span> &lt;span style="color:#ae81ff">60&lt;/span> &lt;span style="color:#f92672">/&lt;/span> &lt;span style="color:#ae81ff">60&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">var&lt;/span> &lt;span style="color:#a6e22e">min&lt;/span> &lt;span style="color:#f92672">=&lt;/span> Math.&lt;span style="color:#a6e22e">floor&lt;/span>(&lt;span style="color:#66d9ef">this&lt;/span>.&lt;span style="color:#a6e22e">playtime&lt;/span>() &lt;span style="color:#f92672">/&lt;/span> &lt;span style="color:#ae81ff">60&lt;/span>) &lt;span style="color:#f92672">%&lt;/span> &lt;span style="color:#ae81ff">60&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">var&lt;/span> &lt;span style="color:#a6e22e">sec&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">this&lt;/span>.&lt;span style="color:#a6e22e">playtime&lt;/span>() &lt;span style="color:#f92672">%&lt;/span> &lt;span style="color:#ae81ff">60&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">hour&lt;/span>.&lt;span style="color:#a6e22e">padZero&lt;/span>(&lt;span style="color:#ae81ff">2&lt;/span>) &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#e6db74">&amp;#39;:&amp;#39;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#a6e22e">min&lt;/span>.&lt;span style="color:#a6e22e">padZero&lt;/span>(&lt;span style="color:#ae81ff">2&lt;/span>) &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#e6db74">&amp;#39;:&amp;#39;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#a6e22e">sec&lt;/span>.&lt;span style="color:#a6e22e">padZero&lt;/span>(&lt;span style="color:#ae81ff">2&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>A quick explanation: whenever you save, the game includes the amount of frames it has rendered in the save file because &lt;code>Game_System&lt;/code> is serialized in the save file and &lt;code>_framesOnSave&lt;/code> is a field of that object. Of course when you load the save will get deserialized and &lt;code>Graphics.frameCount&lt;/code> will be set back to that value. In case you are wondering: &lt;code>Graphics.frameCount&lt;/code> gets incremented on each render.&lt;/p>
&lt;p>This is fine so far but the real problems are found in the &lt;code>playtime&lt;/code> and &lt;code>playtimeText&lt;/code> functions where the game assumes you constantly playing at 60 frames per second. The pure &lt;code>frameCount&lt;/code> gets divided by &lt;code>60&lt;/code> to get the amount of seconds passed and in &lt;code>playtimeText&lt;/code> that result is further processed to the get hours and minutes.&lt;/p>
&lt;p>Due to the multiple issues outlined at the beginning you can see that this is not a good idea. Having said that: let&amp;rsquo;s look at how to fix this.&lt;/p>
&lt;h3 id="possible-solution">Possible Solution&lt;/h3>
&lt;p>This solution is probably the easiest and most straightforward one I can think of:&lt;/p>
&lt;ul>
&lt;li>on load/start: set &lt;code>startTime&lt;/code> to the current time&lt;/li>
&lt;li>on save:
&lt;ol>
&lt;li>get the current time and calculate the difference between now and &lt;code>startTime&lt;/code>&lt;/li>
&lt;li>add the difference to a variable in the save&lt;/li>
&lt;/ol>
&lt;/li>
&lt;/ul>
&lt;p>No need for frame count calculations or anything complex, just use &lt;code>Date.now()&lt;/code> a few times and get the difference.&lt;/p>
&lt;h3 id="changing-the-implementation-in-rpg-maker-mv">Changing the implementation in RPG Maker MV&lt;/h3>
&lt;p>Start by opening &lt;code>js/rpg_objects.js&lt;/code> and look for the &lt;code>initialize&lt;/code> function. Here we want to add two new fields:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-javascript" data-lang="javascript">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">Game_System&lt;/span>.&lt;span style="color:#a6e22e">prototype&lt;/span>.&lt;span style="color:#a6e22e">initialize&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">function&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">this&lt;/span>.&lt;span style="color:#a6e22e">_startTime&lt;/span> &lt;span style="color:#f92672">=&lt;/span> Date.&lt;span style="color:#a6e22e">now&lt;/span>();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">this&lt;/span>.&lt;span style="color:#a6e22e">_playtime&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// ...
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>Date.now()&lt;/code> returns the current &lt;a href="https://currentmillis.com/">Unix time&lt;/a> as an integer that looks like this: &lt;code>1632928643900&lt;/code>.&lt;/p>
&lt;p>We need to set the start time in the &lt;code>initialize&lt;/code> function for when the game starts and in the &lt;code>onAfterLoad&lt;/code> function for when the player loads a save file:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-javascript" data-lang="javascript">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">Game_System&lt;/span>.&lt;span style="color:#a6e22e">prototype&lt;/span>.&lt;span style="color:#a6e22e">onAfterLoad&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">function&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">this&lt;/span>.&lt;span style="color:#a6e22e">_startTime&lt;/span> &lt;span style="color:#f92672">=&lt;/span> Date.&lt;span style="color:#a6e22e">now&lt;/span>();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// ...
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>The &lt;code>onBeforeSave&lt;/code> function gets called before the save is serialized so here we have to calculate the time difference and reset the start time:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-javascript" data-lang="javascript">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">Game_System&lt;/span>.&lt;span style="color:#a6e22e">prototype&lt;/span>.&lt;span style="color:#a6e22e">onBeforeSave&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">function&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">this&lt;/span>.&lt;span style="color:#a6e22e">_playtime&lt;/span> &lt;span style="color:#f92672">+=&lt;/span> Date.&lt;span style="color:#a6e22e">now&lt;/span>() &lt;span style="color:#f92672">-&lt;/span> &lt;span style="color:#66d9ef">this&lt;/span>.&lt;span style="color:#a6e22e">_startTime&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">this&lt;/span>.&lt;span style="color:#a6e22e">_startTime&lt;/span> &lt;span style="color:#f92672">=&lt;/span> Date.&lt;span style="color:#a6e22e">now&lt;/span>();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// ...
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Assuming the player started at &lt;code>1632928643900&lt;/code> and played for 1 second till &lt;code>1632928644900&lt;/code>, &lt;code>this._playtime&lt;/code> will now be &lt;code>1000&lt;/code>. The only thing remaining is updating the &lt;code>playtime&lt;/code> function:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-javascript" data-lang="javascript">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">Game_System&lt;/span>.&lt;span style="color:#a6e22e">prototype&lt;/span>.&lt;span style="color:#a6e22e">playtime&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">function&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> Math.&lt;span style="color:#a6e22e">floor&lt;/span>(&lt;span style="color:#66d9ef">this&lt;/span>.&lt;span style="color:#a6e22e">_playtime&lt;/span> &lt;span style="color:#f92672">/&lt;/span> &lt;span style="color:#ae81ff">1000&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Since this function returns the amount of time passed in seconds we have to divide by 1000 to convert from milliseconds to seconds. While we are at it, I also recommend updating &lt;code>playtimeText&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-javascript" data-lang="javascript">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">Game_System&lt;/span>.&lt;span style="color:#a6e22e">prototype&lt;/span>.&lt;span style="color:#a6e22e">playtimeText&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">function&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">var&lt;/span> &lt;span style="color:#a6e22e">secondsPassed&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">this&lt;/span>.&lt;span style="color:#a6e22e">playtime&lt;/span>();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">var&lt;/span> &lt;span style="color:#a6e22e">minutesPassed&lt;/span> &lt;span style="color:#f92672">=&lt;/span> Math.&lt;span style="color:#a6e22e">floor&lt;/span>(&lt;span style="color:#a6e22e">secondsPassed&lt;/span> &lt;span style="color:#f92672">/&lt;/span> &lt;span style="color:#ae81ff">60&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">var&lt;/span> &lt;span style="color:#a6e22e">hoursPassed&lt;/span> &lt;span style="color:#f92672">=&lt;/span> Math.&lt;span style="color:#a6e22e">floor&lt;/span>(&lt;span style="color:#a6e22e">minutesPassed&lt;/span> &lt;span style="color:#f92672">/&lt;/span> &lt;span style="color:#ae81ff">60&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">var&lt;/span> &lt;span style="color:#a6e22e">sec&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">secondsPassed&lt;/span> &lt;span style="color:#f92672">%&lt;/span> &lt;span style="color:#ae81ff">60&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">var&lt;/span> &lt;span style="color:#a6e22e">min&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">minutesPassed&lt;/span> &lt;span style="color:#f92672">%&lt;/span> &lt;span style="color:#ae81ff">60&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">var&lt;/span> &lt;span style="color:#a6e22e">hour&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">hoursPassed&lt;/span> &lt;span style="color:#f92672">%&lt;/span> &lt;span style="color:#ae81ff">24&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">hour&lt;/span>.&lt;span style="color:#a6e22e">padZero&lt;/span>(&lt;span style="color:#ae81ff">2&lt;/span>) &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#e6db74">&amp;#39;:&amp;#39;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#a6e22e">min&lt;/span>.&lt;span style="color:#a6e22e">padZero&lt;/span>(&lt;span style="color:#ae81ff">2&lt;/span>) &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#e6db74">&amp;#39;:&amp;#39;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#a6e22e">sec&lt;/span>.&lt;span style="color:#a6e22e">padZero&lt;/span>(&lt;span style="color:#ae81ff">2&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>The main difference here is that we cache the result from the &lt;code>playtime&lt;/code> function and other operations.&lt;/p>
&lt;h3 id="plugin-for-mvmz">Plugin for MV/MZ&lt;/h3>
&lt;p>If you don&amp;rsquo;t want to mess with the game files directly, which is a good idea, then I suggest taking a look at the &lt;a href="https://github.com/erri120/RPGMakerPlugins#playtimefix">&lt;code>PlaytimeFix&lt;/code> plugin&lt;/a> which I developed that does everything explained in this post.&lt;/p>
&lt;h2 id="afterword">Afterword&lt;/h2>
&lt;p>This issue has been bugging me a lot during my playthroughs of longer games because you don&amp;rsquo;t really notice it when your playtime goes from 1h to 2 hours but going from 21 hours to 50+ hours was a bit more in my face. RPG Maker MZ also doesn&amp;rsquo;t fix this and I have not seen any discussion about this.&lt;/p>
&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>See &lt;code>Time.deltaTime&lt;/code> in the docs &lt;a href="https://docs.unity3d.com/ScriptReference/Time-deltaTime.html">here&lt;/a>&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div></content></item><item><title>CI/CD for RPG Maker Game Development</title><link>https://erri120.github.io/posts/2021-02-04/</link><pubDate>Thu, 04 Feb 2021 15:41:07 +0100</pubDate><guid>https://erri120.github.io/posts/2021-02-04/</guid><description>Automation saves time and therefore money. However you have to ask yourself if it&amp;rsquo;s worth spending hours writing a complex and long script. In the worst case you might end up wasting instead of saving time. Thankfully most programming related tasks can be automated very quickly and each language or framework often has documentation on how to get you up and running.
This is sadly not often the case when it comes to game development.</description><content>&lt;p>Automation saves time and therefore money. However you have to ask yourself if it&amp;rsquo;s worth spending hours writing a complex and long script. In the worst case you might end up wasting instead of saving time. Thankfully most programming related tasks can be automated very quickly and each language or framework often has documentation on how to get you up and running.&lt;/p>
&lt;p>This is sadly not often the case when it comes to game development. Popular engines like Unreal Engine and Unity have automation tools &lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup> and documentation for automating the build process but less popular ones such as RPG Maker don&amp;rsquo;t have those.&lt;/p>
&lt;p>In this post I will explain what CI/CD means and how to set up a pipeline for RPG Maker MV/MZ with &lt;a href="https://github.com/erri120/rpgmpacker">rpgmpacker&lt;/a>. A big chunk of this post is explaining CI/CD and how RPG Maker MV/MZ works, if you just want to go to the practical part click &lt;a href="#using-rpgmpacker">here&lt;/a>.&lt;/p>
&lt;h2 id="cicd-for-non-programmers">CI/CD for non-programmers&lt;/h2>
&lt;p>RPG Maker is very non-programmer friendly and you can easily end up not having to write a single line of code when creating a game with it. For this reason I want to make sure we all have the same base level understanding of CI/CD before continuing. That being said, I expect you to know about version control with git so make sure to watch these two amazing videos by &lt;a href="https://www.youtube.com/channel/UCsBjURrPoezykLs9EqgamOA">Fireship&lt;/a> if you are unfamiliar with it:&lt;/p>
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe src="https://www.youtube-nocookie.com/embed/hwP7WQkmECE" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video">&lt;/iframe>
&lt;/div>
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe src="https://www.youtube-nocookie.com/embed/HkdAHXoRtos" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video">&lt;/iframe>
&lt;/div>
&lt;p>Let&amp;rsquo;s get started with &lt;strong>Continuous Integration&lt;/strong> which means running a pipeline on every change you commit to a repository. This pipeline consists of one or multiple jobs where one job could be running some tests or building the project. If you run the tests on every change then you can easily track down the commit where a bug was introduced to the codebase. A common pipeline would look like this:&lt;/p>
&lt;ol>
&lt;li>setup (checkout, getting all the tools)&lt;/li>
&lt;li>running tests&lt;/li>
&lt;li>building the project&lt;/li>
&lt;li>packaging&lt;/li>
&lt;li>uploading an artifact (fancy word for an archive containing the output)&lt;/li>
&lt;/ol>
&lt;p>The terminology can be different depending on your provider for example a pipeline on GitHub is called a workflow and each workflow has steps instead of jobs. They often mean the same thing so don&amp;rsquo;t let that confuse you.&lt;/p>
&lt;p>&lt;strong>Continuous Delivery&lt;/strong> is about &lt;em>delivering&lt;/em> the artifact we produced previously. This artifact can be send to testers, friends, the QA team or your mom. &lt;strong>Continuous Deployment&lt;/strong> is also a thing and means actually deploying the artifact by uploading the next release of a game to itch.io or deploying the software to your servers.&lt;/p>
&lt;p>Big studios often end up with huge pipelines because they have many employees and teams. They might have a CI pipeline that runs the tests and builds the project. The artifact would then send in a CD pipeline to the testers or QA team and when they approve of the build it gets released into the world. This is probably not the case for you or your team and most of the time you can combine all of this into one pipeline.&lt;/p>
&lt;p>If you are curious how such a pipeline might look like, here is the GitHub Actions workflow file that builds (CI) and deploys (CD) this site to GitHub Pages on every push to the master branch:&lt;/p>
&lt;div class="collapsable-code">
&lt;input id="756283491" type="checkbox" />
&lt;label for="756283491">
&lt;span class="collapsable-code__language">yaml&lt;/span>
&lt;span class="collapsable-code__title">Example GitHub Actions workflow&lt;/span>
&lt;span class="collapsable-code__toggle" data-label-expand="Show" data-label-collapse="Hide">&lt;/span>
&lt;/label>
&lt;pre class="language-yaml" >&lt;code>
name: Deployment
on:
push:
branches: [ master ]
jobs:
build:
runs-on: ubuntu-latest
steps:
# setup
- uses: actions/checkout@v2
with:
submodules: true
fetch-depth: 0
- name: Setup Hugo
uses: peaceiris/actions-hugo@v2
with:
hugo-version: &amp;#39;latest&amp;#39;
# building the site (CI)
- name: Build
run: hugo --minify
# deploying the site (CD)
- name: Deploy
uses: peaceiris/actions-gh-pages@v3
with:
github_token: ${{ secrets.GITHUB_TOKEN }}
publish_dir: ./public
publish_branch: gh-pages
&lt;/code>&lt;/pre>
&lt;/div>
&lt;h2 id="rpg-maker-mvmz-manual-export">RPG Maker MV/MZ manual export&lt;/h2>
&lt;img src="https://erri120.github.io/img/posts/2021-02-04/RPGMakerMV-Deployment.png" alt="RPG Maker MV Deployment Window" class="left" />
&lt;p>This is the deployment window of RPG Maker MV which you can access in the editor under &lt;em>File -&amp;gt; Deployment&lt;/em>. The major issue with this is the fact you have to use it at all. Software developers love the tools they can use from the command line because they can be easily accessed using a script.&lt;/p>
&lt;p>Other engines likes Unreal Engine have to compile code before deployment but RPG Maker is very different: It&amp;rsquo;s only copying files from one place to another.&lt;/p>
&lt;p>There is no code to compile because all the code is in JavaScript, it doesn&amp;rsquo;t even need to compile an executable because it just uses &lt;a href="https://nwjs.io/">NW.js&lt;/a>. RPG Maker is one of the simplest game engines, not just in terms of usability but how everything is just JSON and JavaScript. You can literally go into the &lt;code>js&lt;/code> folder and look at all the source code of the engine. All the data is saved as JSON so if you want to change the name of an item you can open &lt;code>data/Items.json&lt;/code> and change the values.&lt;/p>
&lt;p>If you are curious where all those files come from, open your RPG Maker MV/MZ installation folder and look for folders that start with &lt;code>nw-js-&lt;/code>. The files inside those folders are copied over to the output directory. You can also find the default template files in the &lt;code>NewData&lt;/code> folders.&lt;/p>
&lt;p>Simply copying files from one place to another can be done with a script. This was exactly what rpgmpacker did in my first prototype but I soon realized that there was more going on.&lt;/p>
&lt;p>First we have file filtering. For audio you can have &lt;code>.ogg&lt;/code> and &lt;code>.m4a&lt;/code> files but exporting for Windows/OSX will only copy the &lt;code>.ogg&lt;/code> files while exporting for Mobile will only copy &lt;code>.m4a&lt;/code> files. Then we have image and audio &amp;ldquo;encryption&amp;rdquo; and the exclude-unused feature which requires parsing of almost all JSON files to figure out which files are actually in use and which are not. There is even more to this which can&amp;rsquo;t be done in a simple script so I decided to build an entire tool which we are going to use in the pipeline.&lt;/p>
&lt;h2 id="creating-a-release-pipeline-for-rpg-maker">Creating a Release Pipeline for RPG Maker&lt;/h2>
&lt;p>The pipeline we are going to build will do the following:&lt;/p>
&lt;ol>
&lt;li>run rpgmpacker&lt;/li>
&lt;li>zip the output&lt;/li>
&lt;li>upload the output to itch.io using &lt;a href="https://itch.io/docs/butler">Butler&lt;/a>&lt;/li>
&lt;/ol>
&lt;p>If your game is not on itch.io then you can leave out the last step or replace it with an upload to MEGA, GDrive or your hosting platform of choice.&lt;/p>
&lt;p>For the pipeline you can write a Bash or PowerShell script, just pick whatever you like more:&lt;/p>
&lt;div class="collapsable-code">
&lt;input id="469831725" type="checkbox" />
&lt;label for="469831725">
&lt;span class="collapsable-code__language">bash&lt;/span>
&lt;span class="collapsable-code__title">Using rpgmpacker in a Bash Script&lt;/span>
&lt;span class="collapsable-code__toggle" data-label-expand="Show" data-label-collapse="Hide">&lt;/span>
&lt;/label>
&lt;pre class="language-bash" >&lt;code>
#!/bin/bash
INPUT=&amp;#34;./MyProject&amp;#34;
OUTPUT=&amp;#34;./build&amp;#34;
RPGMAKER=&amp;#34;M:\\SteamLibrary\\steamapps\\common\\RPG Maker MV&amp;#34;
npx rpgmpacker@latest \
--input &amp;#34;$INPUT&amp;#34; \
--output &amp;#34;$OUTPUT&amp;#34; \
--rpgmaker &amp;#34;$RPGMAKER&amp;#34; \
--exclude \
--noempty \
--debug \
--platforms &amp;#34;Windows&amp;#34; &amp;#34;OSX&amp;#34; &amp;#34;Linux&amp;#34;
&lt;/code>&lt;/pre>
&lt;/div>
&lt;div class="collapsable-code">
&lt;input id="263841957" type="checkbox" />
&lt;label for="263841957">
&lt;span class="collapsable-code__language">powershell&lt;/span>
&lt;span class="collapsable-code__title">Using rpgmpacker in a PowerShell Script&lt;/span>
&lt;span class="collapsable-code__toggle" data-label-expand="Show" data-label-collapse="Hide">&lt;/span>
&lt;/label>
&lt;pre class="language-powershell" >&lt;code>
$PROJECT=&amp;#34;./MyProject&amp;#34;
$OUTPUT=&amp;#34;./build&amp;#34;
$RPGMAKER=&amp;#34;M:\\SteamLibrary\\steamapps\\common\\RPG Maker MV&amp;#34;
npx rpgmpacker@latest `
--input $PROJECT `
--output $OUTPUT `
--rpgmaker $RPGMAKER `
--exclude `
--noempty `
--debug `
--platforms &amp;#34;Windows&amp;#34; &amp;#34;OSX&amp;#34; &amp;#34;Linux&amp;#34;
&lt;/code>&lt;/pre>
&lt;/div>
&lt;p>In my case I have the project in a folder called &lt;code>MyProject&lt;/code> next to the script and the output should go into the &lt;code>build&lt;/code> folder. I&amp;rsquo;m using the Steam version of RPG Maker MV for this but any version of MV or MZ can be used.&lt;/p>
&lt;p>Next up we want to zip the output. rpgmpacker will create an output folder for each platform you specified so for me I will have &lt;code>build/Windows&lt;/code>, &lt;code>build/OSX&lt;/code> and a &lt;code>build/Linux&lt;/code> folder.&lt;/p>
&lt;div class="collapsable-code">
&lt;input id="128435967" type="checkbox" />
&lt;label for="128435967">
&lt;span class="collapsable-code__language">bash&lt;/span>
&lt;span class="collapsable-code__title">Zipping the output in a Bash Script&lt;/span>
&lt;span class="collapsable-code__toggle" data-label-expand="Show" data-label-collapse="Hide">&lt;/span>
&lt;/label>
&lt;pre class="language-bash" >&lt;code>
for platform in $OUTPUT/*; do
7z a -tzip -o$OUTPUT $platform.zip $platform/*
done
&lt;/code>&lt;/pre>
&lt;/div>
&lt;div class="collapsable-code">
&lt;input id="198637452" type="checkbox" />
&lt;label for="198637452">
&lt;span class="collapsable-code__language">powershell&lt;/span>
&lt;span class="collapsable-code__title">Zipping the output in a PowerShell Script&lt;/span>
&lt;span class="collapsable-code__toggle" data-label-expand="Show" data-label-collapse="Hide">&lt;/span>
&lt;/label>
&lt;pre class="language-powershell" >&lt;code>
$Platforms = Get-ChildItem -Path $OUTPUT -Directory -Name
foreach ($platform in $Platforms) {
7z a -tzip -o$OUTPUT $OUTPUT/$platform.zip $OUTPUT/$platform/*
}
&lt;/code>&lt;/pre>
&lt;/div>
&lt;p>This is where the difference between PowerShell and Bash start to appear. In Bash we use a glob to get all top-level items of the output directory and in PowerShell we use the &lt;code>Get-ChildItem&lt;/code> function. They look different but they do the same thing with the main difference being that &lt;code>platform&lt;/code> in Bash will be &lt;code>./build/Windows&lt;/code> while &lt;code>$platform&lt;/code> in PowerShell will be just &lt;code>Windows&lt;/code>. This is why we need to prefix &lt;code>$platform&lt;/code> with &lt;code>$OUTPUT/&lt;/code> when calling 7z.&lt;/p>
&lt;p>The pipeline is almost done at this point. Next is publishing the output with &lt;a href="https://itch.io/docs/butler">Butler&lt;/a> to itch.io but if you are not using that platform you are now done.&lt;/p>
&lt;div class="collapsable-code">
&lt;input id="891246753" type="checkbox" />
&lt;label for="891246753">
&lt;span class="collapsable-code__language">bash&lt;/span>
&lt;span class="collapsable-code__title">Downloading Butler in a Bash Script&lt;/span>
&lt;span class="collapsable-code__toggle" data-label-expand="Show" data-label-collapse="Hide">&lt;/span>
&lt;/label>
&lt;pre class="language-bash" >&lt;code>
# see https://broth.itch.ovh/butler
ButlerChannel=&amp;#34;windows-amd64&amp;#34; # darwin-amd64 for Mac and linux-amd64 for Linux
ButlerVersion=&amp;#34;15.21.0&amp;#34;
ButlerOutput=&amp;#34;butler-$ButlerVersion-$ButlerChannel&amp;#34;
if [ ! -d $ButlerOutput ]; then
curl -L -o butler.zip https://broth.itch.ovh/butler/$butlerChannel/$butlerVersion/archive/default
unzip -o butler.zip -d $ButlerOutput
rm butler.zip
else
echo &amp;#34;Butler version $ButlerVersion ($ButlerChannel) has already been downloaded&amp;#34;
fi
# change butler.exe to just butler if you are on Unix
butler=&amp;#34;$ButlerOutput/butler.exe&amp;#34;
&lt;/code>&lt;/pre>
&lt;/div>
&lt;div class="collapsable-code">
&lt;input id="125473986" type="checkbox" />
&lt;label for="125473986">
&lt;span class="collapsable-code__language">powershell&lt;/span>
&lt;span class="collapsable-code__title">Downloading Buttler in a PowerShell Script&lt;/span>
&lt;span class="collapsable-code__toggle" data-label-expand="Show" data-label-collapse="Hide">&lt;/span>
&lt;/label>
&lt;pre class="language-powershell" >&lt;code>
# see https://broth.itch.ovh/butler
$ButlerChannel=&amp;#34;windows-amd64&amp;#34; # darwin-amd64 for Mac and linux-amd64 for Linux
$ButlerVersion=&amp;#34;15.21.0&amp;#34;
$ButlerOutput=&amp;#34;butler-$ButlerVersion-$ButlerChannel&amp;#34;
if (![System.IO.Directory]::Exists($ButlerOutput)) {
Invoke-WebRequest -OutFile butler.zip &amp;#34;https://broth.itch.ovh/butler/$butlerChannel/$butlerVersion/archive/default&amp;#34;
Expand-Archive -Path butler.zip $ButlerOutput
Remove-Item -Path butler.zip
} else {
Write-Output &amp;#34;Butler version $ButlerVersion ($ButlerChannel) has already been downloaded&amp;#34;
}
# change butler.exe to just butler if you are on Unix
$butler=&amp;#34;$ButlerOutput/butler.exe&amp;#34;
&lt;/code>&lt;/pre>
&lt;/div>
&lt;p>If you are not on windows you should change the &lt;code>ButlerChannel&lt;/code> variable to &lt;code>darwin-amd64&lt;/code> or &lt;code>linux-amd64&lt;/code> depending on your system. I recommend checking &lt;a href="https://broth.itch.ovh/butler">the channel list&lt;/a> of Butler if you need something different. I&amp;rsquo;ve added a simple check so we don&amp;rsquo;t download Butler whenever we call the script. Before we continue you should get an API key from &lt;a href="https://itch.io/user/settings/api-keys">itch.io&lt;/a>. You should treat API keys like passwords and should never make them public. A good way of storing API keys is with environment variables and Butler expects the API key to be stored in the &lt;code>BUTLER_API_KEY&lt;/code> environment variable.&lt;/p>
&lt;div class="collapsable-code">
&lt;input id="291786534" type="checkbox" />
&lt;label for="291786534">
&lt;span class="collapsable-code__language">bash&lt;/span>
&lt;span class="collapsable-code__title">Using Buttler in a Bash Script&lt;/span>
&lt;span class="collapsable-code__toggle" data-label-expand="Show" data-label-collapse="Hide">&lt;/span>
&lt;/label>
&lt;pre class="language-bash" >&lt;code>
export BUTLER_API_KEY=&amp;#34;YOUR_KEY&amp;#34;
ButlerProject=&amp;#34;YOUR_USERNAME/YOUR_PROJECT_NAME&amp;#34;
./$butler login
./$butler push $OUTPUT/Windows $ButlerProject:windows-beta
./$butler push $OUTPUT/OSX $ButlerProject:osx-beta
./$butler push $OUTPUT/Linux $ButlerProject:linux-beta
&lt;/code>&lt;/pre>
&lt;/div>
&lt;div class="collapsable-code">
&lt;input id="754632981" type="checkbox" />
&lt;label for="754632981">
&lt;span class="collapsable-code__language">powershell&lt;/span>
&lt;span class="collapsable-code__title">Using Buttler in a PowerShell Script&lt;/span>
&lt;span class="collapsable-code__toggle" data-label-expand="Show" data-label-collapse="Hide">&lt;/span>
&lt;/label>
&lt;pre class="language-powershell" >&lt;code>
$env:BUTLER_API_KEY=&amp;#34;YOUR_KEY&amp;#34;
$ButlerProject=&amp;#34;YOUR_USERNAME/YOUR_PROJECT_NAME&amp;#34;
&amp;amp;$butler login
&amp;amp;$butler push $OUTPUT/Windows.zip &amp;#34;${ButlerProject}:windows-beta&amp;#34;
&amp;amp;$butler push $OUTPUT/OSX.zip &amp;#34;${ButlerProject}:osx-beta&amp;#34;
&amp;amp;$butler push $OUTPUT/Linux.zip &amp;#34;${ButlerProject}:linux-beta&amp;#34;
&lt;/code>&lt;/pre>
&lt;/div>
&lt;p>I recommend that you look at the &lt;a href="https://itch.io/docs/butler/pushing.html">Butler Docs&lt;/a> for the different channels you can push to. To recap here are both complete scripts:&lt;/p>
&lt;h3 id="finished-scripts">Finished Scripts&lt;/h3>
&lt;div class="collapsable-code">
&lt;input id="471236859" type="checkbox" />
&lt;label for="471236859">
&lt;span class="collapsable-code__language">bash&lt;/span>
&lt;span class="collapsable-code__title">Bash Script&lt;/span>
&lt;span class="collapsable-code__toggle" data-label-expand="Show" data-label-collapse="Hide">&lt;/span>
&lt;/label>
&lt;pre class="language-bash" >&lt;code>
#!/bin/bash
INPUT=&amp;#34;./MyProject&amp;#34;
OUTPUT=&amp;#34;./build&amp;#34;
RPGMAKER=&amp;#34;M:\\SteamLibrary\\steamapps\\common\\RPG Maker MV&amp;#34;
npx rpgmpacker@latest \
--input &amp;#34;$INPUT&amp;#34; \
--output &amp;#34;$OUTPUT&amp;#34; \
--rpgmaker &amp;#34;$RPGMAKER&amp;#34; \
--exclude \
--noempty \
--debug \
--platforms &amp;#34;Windows&amp;#34; &amp;#34;OSX&amp;#34; &amp;#34;Linux&amp;#34;
for platform in $OUTPUT/*; do
7z a -tzip -o$OUTPUT $platform.zip $platform/*
done
# see https://broth.itch.ovh/butler
ButlerChannel=&amp;#34;windows-amd64&amp;#34; # darwin-amd64 for Mac and linux-amd64 for Linux
ButlerVersion=&amp;#34;15.21.0&amp;#34;
ButlerOutput=&amp;#34;butler-$ButlerVersion-$ButlerChannel&amp;#34;
if [ ! -d $ButlerOutput ]; then
curl -L -o butler.zip https://broth.itch.ovh/butler/$butlerChannel/$butlerVersion/archive/default
unzip -o butler.zip -d $ButlerOutput
rm butler.zip
else
echo &amp;#34;Butler version $ButlerVersion ($ButlerChannel) has already been downloaded&amp;#34;
fi
# change butler.exe to just butler if you are on Unix
butler=&amp;#34;$ButlerOutput/butler.exe&amp;#34;
export BUTLER_API_KEY=&amp;#34;YOUR_KEY&amp;#34;
ButlerProject=&amp;#34;YOUR_USERNAME/YOUR_PROJECT_NAME&amp;#34;
./$butler login
./$butler push $OUTPUT/Windows $ButlerProject:windows-beta
./$butler push $OUTPUT/OSX $ButlerProject:osx-beta
./$butler push $OUTPUT/Linux $ButlerProject:linux-beta
&lt;/code>&lt;/pre>
&lt;/div>
&lt;div class="collapsable-code">
&lt;input id="815372469" type="checkbox" />
&lt;label for="815372469">
&lt;span class="collapsable-code__language">powershell&lt;/span>
&lt;span class="collapsable-code__title">PowerShell Script&lt;/span>
&lt;span class="collapsable-code__toggle" data-label-expand="Show" data-label-collapse="Hide">&lt;/span>
&lt;/label>
&lt;pre class="language-powershell" >&lt;code>
$PROJECT=&amp;#34;./MyProject&amp;#34;
$OUTPUT=&amp;#34;./build&amp;#34;
$RPGMAKER=&amp;#34;M:\\SteamLibrary\\steamapps\\common\\RPG Maker MV&amp;#34;
npx rpgmpacker@latest `
--input $PROJECT `
--output $OUTPUT `
--rpgmaker $RPGMAKER `
--exclude `
--noempty `
--debug `
--platforms &amp;#34;Windows&amp;#34; &amp;#34;OSX&amp;#34; &amp;#34;Linux&amp;#34;
$Platforms = Get-ChildItem -Path $OUTPUT -Directory -Name
foreach ($platform in $Platforms) {
7z a -tzip -o$OUTPUT $OUTPUT/$platform.zip $OUTPUT/$platform/*
}
# see https://broth.itch.ovh/butler
$ButlerChannel=&amp;#34;windows-amd64&amp;#34; # darwin-amd64 for Mac and linux-amd64 for Linux
$ButlerVersion=&amp;#34;15.21.0&amp;#34;
$ButlerOutput=&amp;#34;butler-$ButlerVersion-$ButlerChannel&amp;#34;
if (![System.IO.Directory]::Exists($ButlerOutput)) {
Invoke-WebRequest -OutFile butler.zip &amp;#34;https://broth.itch.ovh/butler/$butlerChannel/$butlerVersion/archive/default&amp;#34;
Expand-Archive -Path butler.zip $ButlerOutput
Remove-Item -Path butler.zip
} else {
Write-Output &amp;#34;Butler version $ButlerVersion ($ButlerChannel) has already been downloaded&amp;#34;
}
# change butler.exe to just butler if you are on Unix
$butler=&amp;#34;$ButlerOutput/butler.exe&amp;#34;
$env:BUTLER_API_KEY=&amp;#34;YOUR_KEY&amp;#34;
$ButlerProject=&amp;#34;YOUR_USERNAME/YOUR_PROJECT_NAME&amp;#34;
&amp;amp;$butler login
&amp;amp;$butler push $OUTPUT/Windows.zip &amp;#34;${ButlerProject}:windows-beta&amp;#34;
&amp;amp;$butler push $OUTPUT/OSX.zip &amp;#34;${ButlerProject}:osx-beta&amp;#34;
&amp;amp;$butler push $OUTPUT/Linux.zip &amp;#34;${ButlerProject}:linux-beta&amp;#34;
&lt;/code>&lt;/pre>
&lt;/div>
&lt;h2 id="conclusion">Conclusion&lt;/h2>
&lt;p>I hope this blog post helped you with getting a CI/CD pipeline up and running for your RPG Maker game. Please let me know if you end up using this tool for your next project. The author of &lt;a href="https://aura-dev.itch.io/star-knightess-aura">Star Knightess Aura (NSFW)&lt;/a> was one of the earliest users and you can find their pipeline in this repo on &lt;a href="https://gitgud.io/aura-dev/star_knightess_aura/-/tree/develop">gitgud&lt;/a>.&lt;/p>
&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>Unreal Engine has &lt;a href="https://docs.unrealengine.com/4.27/en-US/ProductionPipelines/BuildTools/AutomationTool/">Automation Tools&lt;/a> and Unity has a &lt;a href="https://docs.unity3d.com/Manual/CommandLineArguments.html">CLI&lt;/a>&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div></content></item></channel></rss>