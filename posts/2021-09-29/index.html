<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Don't count frames to calculate time | erri120's random Blog</title><meta name=keywords content="Game Development,RPG Maker,JavaScript"><meta name=description content="RPG Maker MV/MZ uses the amount of rendered frames to calculate how long player has been playing the game. They sadly forgot that 60 frames do not always equal 1 second and that you can just use a timestamp instead."><meta name=author content="erri120"><link rel=canonical href=https://erri120.github.io/posts/2021-09-29/><link crossorigin=anonymous href=/assets/css/stylesheet.css rel="preload stylesheet" as=style><link rel=icon href=https://erri120.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://erri120.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://erri120.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://erri120.github.io/apple-touch-icon.png><link rel=mask-icon href=https://erri120.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://erri120.github.io/posts/2021-09-29/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta name=google-site-verification content="c-L5KbBKeVyZ9YNKiotqlpl7zsiDRiGcWJa4ZxVpzAo"><meta name=msvalidate.01 content="0E353603CBFC6B4F85D605C4E9F27290"><script data-goatcounter=https://erri120.goatcounter.com/count async src=//gc.zgo.at/count.js></script><link rel=stylesheet href=/syntax.css><meta property="og:url" content="https://erri120.github.io/posts/2021-09-29/"><meta property="og:site_name" content="erri120's random Blog"><meta property="og:title" content="Don't count frames to calculate time"><meta property="og:description" content="RPG Maker MV/MZ uses the amount of rendered frames to calculate how long player has been playing the game. They sadly forgot that 60 frames do not always equal 1 second and that you can just use a timestamp instead."><meta property="og:locale" content="en-US"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-09-29T00:00:00+00:00"><meta property="article:modified_time" content="2022-11-29T13:34:42+01:00"><meta property="article:tag" content="Game Development"><meta property="article:tag" content="RPG Maker"><meta property="article:tag" content="JavaScript"><meta name=twitter:card content="summary"><meta name=twitter:title content="Don't count frames to calculate time"><meta name=twitter:description content="RPG Maker MV/MZ uses the amount of rendered frames to calculate how long player has been playing the game. They sadly forgot that 60 frames do not always equal 1 second and that you can just use a timestamp instead."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://erri120.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Don't count frames to calculate time","item":"https://erri120.github.io/posts/2021-09-29/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Don't count frames to calculate time","name":"Don\u0027t count frames to calculate time","description":"RPG Maker MV/MZ uses the amount of rendered frames to calculate how long player has been playing the game. They sadly forgot that 60 frames do not always equal 1 second and that you can just use a timestamp instead.","keywords":["Game Development","RPG Maker","JavaScript"],"articleBody":"Time and Frames We have all heard the term FPS, frames per second, which tells us how many frames are rendered on screen within one second. Higher FPS will result in smoother animations because those animations get more frames. The problem with high FPS is that the GPU has to keep up with this demand and be able to produce 30/60/144 or more frames within 1 second. This is where frame times, VSync and a bunch of offer stuff that I won’t cover here comes into play.\nThe important takeaway is that you can not reliably calculate a duration based on how many frames where rendered because not every frame takes the same amount of time. This is a problem when you want to smoothly move an object from one position to another. Engines like Unity solve this by providing a delta time which is the interval from the last to the current frame, allowing you to create smooth translations.\nLooking at RPG Maker MV/MZ So what issue does RPG Maker have? I have recently played a game for around 21 hours, but the save menu displayed over 51 hours, more than double. Actually not just more than double but around 2.4 times more than expected. This quickly made me realize that I had been playing the game on my 144Hz monitor, meaning instead of rendering at 60 FPS, the game was rendering at 144 FPS. I hope you notice that 60 x 2.4 equals 144.\nTo further investigate the problem I took a peek inside the js folder, did a quick search for “playtime” and found the culprits of my frustration:\n1 2 3 4 Game_System.prototype.onBeforeSave = function() { this._framesOnSave = Graphics.frameCount; // ... }; 1 2 3 4 Game_System.prototype.onAfterLoad = function() { Graphics.frameCount = this._framesOnSave; // ... }; 1 2 3 Game_System.prototype.playtime = function() { return Math.floor(Graphics.frameCount / 60); }; 1 2 3 4 5 6 Game_System.prototype.playtimeText = function() { var hour = Math.floor(this.playtime() / 60 / 60); var min = Math.floor(this.playtime() / 60) % 60; var sec = this.playtime() % 60; return hour.padZero(2) + ':' + min.padZero(2) + ':' + sec.padZero(2); }; A quick explanation: whenever you save, the game includes the amount of frames it has rendered in the save file because Game_System is serialized and _framesOnSave is a field of that object. When you load, the save will get deserialized and Graphics.frameCount will be set back to that value. In case you are wondering: Graphics.frameCount gets incremented on each render.\nThis is fine so far, but the real problems are found in the playtime and playtimeText functions where the game assumes you are constantly playing at 60 frames per second. The pure frameCount value gets divided by 60 to get the amount of seconds passed and in playtimeText that result is further processed to the get hours and minutes.\nDue to the multiple issues outlined at the beginning you can see that this is not a good idea. Having said that: let’s look at how to fix this.\nPossible Solution This solution is probably the easiest and most straightforward one I can think of:\non load/start: set startTime to the current time on save: get the current time and calculate the difference between now and startTime add the difference to a variable in the save No need for frame count calculations or anything complex, just use Date.now() a few times and get the difference.\nChanging the implementation in RPG Maker MV/MZ Start by opening js/rpg_objects.js and look for the initialize function. Here we want to add two new fields:\n1 2 3 4 5 Game_System.prototype.initialize = function() { this._startTime = Date.now(); this._playtime = 0; // ... } Date.now() returns the current Unix time as an integer that looks like this: 1632928643900.\nWe need to set the start time in the initialize function for when the game starts and in the onAfterLoad function for when the player loads a save file:\n1 2 3 4 Game_System.prototype.onAfterLoad = function() { this._startTime = Date.now(); // ... } The onBeforeSave function gets called before the save is serialized so here we have to calculate the time difference and reset the start time:\n1 2 3 4 5 Game_System.prototype.onBeforeSave = function() { this._playtime += Date.now() - this._startTime; this._startTime = Date.now(); // ... } Assuming the player started at 1632928643900 and played for 1 second till 1632928644900, this._playtime will now be 1000. The only thing remaining is updating the playtime function:\n1 2 3 Game_System.prototype.playtime = function() { return Math.floor(this._playtime / 1000); }; Since this function returns the amount of time passed in seconds we have to divide by 1000 to convert from milliseconds to seconds. While we are at it, I also recommend updating playtimeText:\n1 2 3 4 5 6 7 8 9 10 11 Game_System.prototype.playtimeText = function() { var secondsPassed = this.playtime(); var minutesPassed = Math.floor(secondsPassed / 60); var hoursPassed = Math.floor(minutesPassed / 60); var sec = secondsPassed % 60; var min = minutesPassed % 60; var hour = hoursPassed % 24; return hour.padZero(2) + ':' + min.padZero(2) + ':' + sec.padZero(2); }; The main difference here is that we cache the result from the playtime function and other operations.\nPlugin for MV/MZ If you don’t want to mess with the game files directly, which is a good idea, then I suggest taking a look at the PlaytimeFix plugin which I developed that does everything explained in this post.\nAfterword This issue has been bugging me a lot during my playthroughs of longer games because you don’t really notice it when your playtime goes from 1h to 2 hours but going from 21 hours to 50+ hours was a bit more in my face. RPG Maker MZ also doesn’t fix this, and I have not seen any discussion about this.\n","wordCount":"962","inLanguage":"en","datePublished":"2021-09-29T00:00:00Z","dateModified":"2022-11-29T13:34:42+01:00","author":{"@type":"Person","name":"erri120"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://erri120.github.io/posts/2021-09-29/"},"publisher":{"@type":"Organization","name":"erri120's random Blog","logo":{"@type":"ImageObject","url":"https://erri120.github.io/favicon.ico"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://erri120.github.io/ accesskey=h title="Home (Alt + H)">Home</a><div class=logo-switches></div></div><ul id=menu><li><a href=https://erri120.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://erri120.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://erri120.github.io/archives/ title=Archive><span>Archive</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://erri120.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://erri120.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Don't count frames to calculate time</h1><div class=post-description>RPG Maker MV/MZ uses the amount of rendered frames to calculate how long player has been playing the game. They sadly forgot that 60 frames do not always equal 1 second and that you can just use a timestamp instead.</div><div class=post-meta><span title='2021-09-29 00:00:00 +0000 UTC'>2021-09-29</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;962 words&nbsp;·&nbsp;erri120&nbsp;|&nbsp;<a href=https://github.com/erri120/erri120.github.io/edit/master/content/posts/2021-09-29.md rel="noopener noreferrer edit" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#time-and-frames>Time and Frames</a></li><li><a href=#looking-at-rpg-maker-mvmz>Looking at RPG Maker MV/MZ</a><ul><li><a href=#possible-solution>Possible Solution</a></li><li><a href=#changing-the-implementation-in-rpg-maker-mvmz>Changing the implementation in RPG Maker MV/MZ</a></li><li><a href=#plugin-for-mvmz>Plugin for MV/MZ</a></li></ul></li><li><a href=#afterword>Afterword</a></li></ul></nav></div></details></div><div class=post-content><h2 id=time-and-frames>Time and Frames<a hidden class=anchor aria-hidden=true href=#time-and-frames>#</a></h2><p>We have all heard the term FPS, frames per second, which tells us how many frames are rendered on screen within one second. Higher FPS will result in smoother animations because those animations get more frames. The problem with high FPS is that the GPU has to keep up with this demand and be able to produce 30/60/144 or more frames within 1 second. This is where frame times, VSync and a bunch of offer stuff that I won&rsquo;t cover here comes into play.</p><p>The important takeaway is that you can not reliably calculate a duration based on how many frames where rendered because not every frame takes the same amount of time. This is a problem when you want to smoothly move an object from one position to another. Engines like Unity solve this by providing a <a href=https://docs.unity3d.com/ScriptReference/Time-deltaTime.html>delta time</a> which is the interval from the last to the current frame, allowing you to create smooth translations.</p><h2 id=looking-at-rpg-maker-mvmz>Looking at RPG Maker MV/MZ<a hidden class=anchor aria-hidden=true href=#looking-at-rpg-maker-mvmz>#</a></h2><p>So what issue does RPG Maker have? I have recently played a game for around 21 hours, but the save menu displayed over 51 hours, more than double. Actually not just more than double but around 2.4 times more than expected. This quickly made me realize that I had been playing the game on my 144Hz monitor, meaning instead of rendering at 60 FPS, the game was rendering at 144 FPS. I hope you notice that <code>60 x 2.4</code> equals <code>144</code>.</p><p>To further investigate the problem I took a peek inside the <code>js</code> folder, did a quick search for &ldquo;playtime&rdquo; and found the culprits of my frustration:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>Game_System</span><span class=p>.</span><span class=nx>prototype</span><span class=p>.</span><span class=nx>onBeforeSave</span> <span class=o>=</span> <span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>_framesOnSave</span> <span class=o>=</span> <span class=nx>Graphics</span><span class=p>.</span><span class=nx>frameCount</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>};</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>Game_System</span><span class=p>.</span><span class=nx>prototype</span><span class=p>.</span><span class=nx>onAfterLoad</span> <span class=o>=</span> <span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>Graphics</span><span class=p>.</span><span class=nx>frameCount</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>_framesOnSave</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>};</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>Game_System</span><span class=p>.</span><span class=nx>prototype</span><span class=p>.</span><span class=nx>playtime</span> <span class=o>=</span> <span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>floor</span><span class=p>(</span><span class=nx>Graphics</span><span class=p>.</span><span class=nx>frameCount</span> <span class=o>/</span> <span class=mi>60</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>Game_System</span><span class=p>.</span><span class=nx>prototype</span><span class=p>.</span><span class=nx>playtimeText</span> <span class=o>=</span> <span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>hour</span> <span class=o>=</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>floor</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>playtime</span><span class=p>()</span> <span class=o>/</span> <span class=mi>60</span> <span class=o>/</span> <span class=mi>60</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>min</span> <span class=o>=</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>floor</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>playtime</span><span class=p>()</span> <span class=o>/</span> <span class=mi>60</span><span class=p>)</span> <span class=o>%</span> <span class=mi>60</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>sec</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>playtime</span><span class=p>()</span> <span class=o>%</span> <span class=mi>60</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>hour</span><span class=p>.</span><span class=nx>padZero</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span> <span class=o>+</span> <span class=s1>&#39;:&#39;</span> <span class=o>+</span> <span class=nx>min</span><span class=p>.</span><span class=nx>padZero</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span> <span class=o>+</span> <span class=s1>&#39;:&#39;</span> <span class=o>+</span> <span class=nx>sec</span><span class=p>.</span><span class=nx>padZero</span><span class=p>(</span><span class=mi>2</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span></code></pre></td></tr></table></div></div><p>A quick explanation: whenever you save, the game includes the amount of frames it has rendered in the save file because <code>Game_System</code> is serialized and <code>_framesOnSave</code> is a field of that object. When you load, the save will get deserialized and <code>Graphics.frameCount</code> will be set back to that value. In case you are wondering: <code>Graphics.frameCount</code> gets incremented on each render.</p><p>This is fine so far, but the real problems are found in the <code>playtime</code> and <code>playtimeText</code> functions where the game assumes you are constantly playing at 60 frames per second. The pure <code>frameCount</code> value gets divided by <code>60</code> to get the amount of seconds passed and in <code>playtimeText</code> that result is further processed to the get hours and minutes.</p><p>Due to the multiple issues outlined at the beginning you can see that this is not a good idea. Having said that: let&rsquo;s look at how to fix this.</p><h3 id=possible-solution>Possible Solution<a hidden class=anchor aria-hidden=true href=#possible-solution>#</a></h3><p>This solution is probably the easiest and most straightforward one I can think of:</p><ul><li>on load/start: set <code>startTime</code> to the current time</li><li>on save:<ol><li>get the current time and calculate the difference between now and <code>startTime</code></li><li>add the difference to a variable in the save</li></ol></li></ul><p>No need for frame count calculations or anything complex, just use <code>Date.now()</code> a few times and get the difference.</p><h3 id=changing-the-implementation-in-rpg-maker-mvmz>Changing the implementation in RPG Maker MV/MZ<a hidden class=anchor aria-hidden=true href=#changing-the-implementation-in-rpg-maker-mvmz>#</a></h3><p>Start by opening <code>js/rpg_objects.js</code> and look for the <code>initialize</code> function. Here we want to add two new fields:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>Game_System</span><span class=p>.</span><span class=nx>prototype</span><span class=p>.</span><span class=nx>initialize</span> <span class=o>=</span> <span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>this</span><span class=p>.</span><span class=nx>_startTime</span> <span class=o>=</span> <span class=nb>Date</span><span class=p>.</span><span class=nx>now</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=k>this</span><span class=p>.</span><span class=nx>_playtime</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p><code>Date.now()</code> returns the current <a href=https://currentmillis.com/>Unix time</a> as an integer that looks like this: <code>1632928643900</code>.</p><p>We need to set the start time in the <code>initialize</code> function for when the game starts and in the <code>onAfterLoad</code> function for when the player loads a save file:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>Game_System</span><span class=p>.</span><span class=nx>prototype</span><span class=p>.</span><span class=nx>onAfterLoad</span> <span class=o>=</span> <span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>this</span><span class=p>.</span><span class=nx>_startTime</span> <span class=o>=</span> <span class=nb>Date</span><span class=p>.</span><span class=nx>now</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>The <code>onBeforeSave</code> function gets called before the save is serialized so here we have to calculate the time difference and reset the start time:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>Game_System</span><span class=p>.</span><span class=nx>prototype</span><span class=p>.</span><span class=nx>onBeforeSave</span> <span class=o>=</span> <span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>this</span><span class=p>.</span><span class=nx>_playtime</span> <span class=o>+=</span> <span class=nb>Date</span><span class=p>.</span><span class=nx>now</span><span class=p>()</span> <span class=o>-</span> <span class=k>this</span><span class=p>.</span><span class=nx>_startTime</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>this</span><span class=p>.</span><span class=nx>_startTime</span> <span class=o>=</span> <span class=nb>Date</span><span class=p>.</span><span class=nx>now</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>Assuming the player started at <code>1632928643900</code> and played for 1 second till <code>1632928644900</code>, <code>this._playtime</code> will now be <code>1000</code>. The only thing remaining is updating the <code>playtime</code> function:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>Game_System</span><span class=p>.</span><span class=nx>prototype</span><span class=p>.</span><span class=nx>playtime</span> <span class=o>=</span> <span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>floor</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>_playtime</span> <span class=o>/</span> <span class=mi>1000</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span></code></pre></td></tr></table></div></div><p>Since this function returns the amount of time passed in seconds we have to divide by 1000 to convert from milliseconds to seconds. While we are at it, I also recommend updating <code>playtimeText</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>Game_System</span><span class=p>.</span><span class=nx>prototype</span><span class=p>.</span><span class=nx>playtimeText</span> <span class=o>=</span> <span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>var</span> <span class=nx>secondsPassed</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>playtime</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=kd>var</span> <span class=nx>minutesPassed</span> <span class=o>=</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>floor</span><span class=p>(</span><span class=nx>secondsPassed</span> <span class=o>/</span> <span class=mi>60</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=kd>var</span> <span class=nx>hoursPassed</span> <span class=o>=</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>floor</span><span class=p>(</span><span class=nx>minutesPassed</span> <span class=o>/</span> <span class=mi>60</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kd>var</span> <span class=nx>sec</span> <span class=o>=</span> <span class=nx>secondsPassed</span> <span class=o>%</span> <span class=mi>60</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kd>var</span> <span class=nx>min</span> <span class=o>=</span> <span class=nx>minutesPassed</span> <span class=o>%</span> <span class=mi>60</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kd>var</span> <span class=nx>hour</span> <span class=o>=</span> <span class=nx>hoursPassed</span> <span class=o>%</span> <span class=mi>24</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>hour</span><span class=p>.</span><span class=nx>padZero</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span> <span class=o>+</span> <span class=s1>&#39;:&#39;</span> <span class=o>+</span> <span class=nx>min</span><span class=p>.</span><span class=nx>padZero</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span> <span class=o>+</span> <span class=s1>&#39;:&#39;</span> <span class=o>+</span> <span class=nx>sec</span><span class=p>.</span><span class=nx>padZero</span><span class=p>(</span><span class=mi>2</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span></code></pre></td></tr></table></div></div><p>The main difference here is that we cache the result from the <code>playtime</code> function and other operations.</p><h3 id=plugin-for-mvmz>Plugin for MV/MZ<a hidden class=anchor aria-hidden=true href=#plugin-for-mvmz>#</a></h3><p>If you don&rsquo;t want to mess with the game files directly, which is a good idea, then I suggest taking a look at the <a href=https://github.com/erri120/RPGMakerPlugins#playtimefix><code>PlaytimeFix</code> plugin</a> which I developed that does everything explained in this post.</p><h2 id=afterword>Afterword<a hidden class=anchor aria-hidden=true href=#afterword>#</a></h2><p>This issue has been bugging me a lot during my playthroughs of longer games because you don&rsquo;t really notice it when your playtime goes from 1h to 2 hours but going from 21 hours to 50+ hours was a bit more in my face. RPG Maker MZ also doesn&rsquo;t fix this, and I have not seen any discussion about this.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://erri120.github.io/tags/game-development/>Game Development</a></li><li><a href=https://erri120.github.io/tags/rpg-maker/>RPG Maker</a></li><li><a href=https://erri120.github.io/tags/javascript/>JavaScript</a></li></ul><nav class=paginav><a class=prev href=https://erri120.github.io/posts/2021-11-18/><span class=title>« Prev</span><br><span>Reworking rpgmpacker: Moving from C++ to TypeScript</span>
</a><a class=next href=https://erri120.github.io/posts/2021-02-04/><span class=title>Next »</span><br><span>CI/CD for RPG Maker Game Development</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Don't count frames to calculate time on x" href="https://x.com/intent/tweet/?text=Don%27t%20count%20frames%20to%20calculate%20time&amp;url=https%3a%2f%2ferri120.github.io%2fposts%2f2021-09-29%2f&amp;hashtags=GameDevelopment%2cRPGMaker%2cJavaScript"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Don't count frames to calculate time on reddit" href="https://reddit.com/submit?url=https%3a%2f%2ferri120.github.io%2fposts%2f2021-09-29%2f&title=Don%27t%20count%20frames%20to%20calculate%20time"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li></ul></footer><script src=https://utteranc.es/client.js repo=erri120/erri120.github.io issue-term=pathname label=site-comment theme=github-light crossorigin=anonymous async></script></article></main><footer class=footer><span>&copy; 2025 <a href=https://erri120.github.io/>erri120's random Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>