<!doctype html><html lang=en><head><title>Reworking rpgmpacker: Moving from C++ to TypeScript :: erri120's very random Blog</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="A quick post explaining my decision of moving from C++ to TypeScript for my project rpgmpacker."><meta name=keywords content="RPG Maker MV,RPG Maker MZ,Continuous Integration,Continuous Deployment,Continuous Delivery,CI/CD,rpgmpacker"><meta name=robots content="noodp"><link rel=canonical href=https://erri120.github.io/posts/2021-11-18/><link rel=stylesheet href=https://erri120.github.io/assets/style.css><link rel=stylesheet href=https://erri120.github.io/assets/organe.css><link rel=apple-touch-icon href=https://erri120.github.io/img/apple-touch-icon-192x192.png><link rel="shortcut icon" href=https://erri120.github.io/favicon.ico><meta name=twitter:card content="summary"><meta name=twitter:site content="erri120"><meta name=twitter:creator content="erri120"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="Reworking rpgmpacker: Moving from C++ to TypeScript"><meta property="og:description" content="A quick post explaining my decision of moving from C++ to TypeScript for my project rpgmpacker."><meta property="og:url" content="https://erri120.github.io/posts/2021-11-18/"><meta property="og:site_name" content="erri120's very random Blog"><meta property="article:published_time" content="2021-11-18 12:18:00 +0100 +0100"><script type=application/ld+json>{"@context":"https://schema.org","@type":"Article","name":"Reworking rpgmpacker: Moving from C\u002b\u002b to TypeScript","description":"A quick post explaining my decision of moving from C\u002b\u002b to TypeScript for my project rpgmpacker.","author":{"@type":"Person","name":"erri120"},"datePublished":"2021-11-18","headling":"Reworking rpgmpacker: Moving from C\u002b\u002b to TypeScript","keywords":"RPG Maker MV, RPG Maker MZ, Continuous Integration, Continuous Deployment, Continuous Delivery, CI\/CD, rpgmpacker"}</script><link href=/posts/2021-11-18/index.xml rel=alternate type=application/rss+xml title="erri120's very random Blog"><meta name=google-site-verification content="c-L5KbBKeVyZ9YNKiotqlpl7zsiDRiGcWJa4ZxVpzAo"><meta name=msvalidate.01 content="0E353603CBFC6B4F85D605C4E9F27290"></head><body class=organe><div class="container center headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>erri120's Blog</div></a></div><div class=menu-trigger>menu</div></div><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=/about>About</a></li></ul><ul class="menu__inner menu__inner--mobile"><li><a href=/about>About</a></li></ul></nav></header><div class=content><main class=post><article><h1 class=post-title><a href=https://erri120.github.io/posts/2021-11-18/>Reworking rpgmpacker: Moving from C++ to TypeScript</a></h1><div class=post-meta><span class=post-date><time datetime=2021-11-18>2021-11-18</time></span>
<span class=post-author>:: erri120</span></div><span class=post-tags>#<a href=https://erri120.github.io/tags/game-development/>Game Development</a>&nbsp;
#<a href=https://erri120.github.io/tags/rpg-maker/>RPG Maker</a>&nbsp;
#<a href=https://erri120.github.io/tags/ci/cd/>CI/CD</a>&nbsp;</span><div class=post-content><div><p><a href=https://github.com/erri120/rpgmpacker>rpgmpacker</a> has been one of my biggest non-modding related projects on GitHub and the only reason people visit my blog:</p><img src=/img/posts/2021-11-18/Blog-Performance.png alt="Top queries of my blog" class=left><p>The developer of the game <a href=https://aura-dev.itch.io/star-knightess-aura>Star Knightess Aura (NSFW)</a> is the first actual user of this tool and contributed a good amount of <a href="https://github.com/erri120/rpgmpacker/issues?q=is%3Aissue+author%3Aauragamedev">issues</a> on GitHub driving the development of this project forward.</p><p>With some issues still open I stopped working on this project in April 2021 because I knew I had to rework this tool at some point and didn&rsquo;t had the motivation to do so at that time. I used C++ for 1.x because I wanted to finally build something with this language. I had only done small assignments in Uni with C++ but never done anything more with it, mainly because the language sucks ass.</p><p>C/C++ is old, very old and it clearly shows, not just in the language but the tooling available. Ask 20 C++ developers what build system they use and you will likely get 10 different answers. Working with dependencies is a nightmare when it comes to C/C++ development. It&rsquo;s actually impossible to count the amount of times I wanted to contribute to a C++ project only to be blocked by some weird build system that only work in a specific environment when the stars align and the moon is in the Waxing Gibbous lunar phase. Once you did get something to work you now have to deal with the language itself. Let me ask you this: how do you represent a string in C++? Did you know that there is <code>std::string</code> which is actually just <code>std::basic_string&lt;char></code>, <code>std::u16string</code> which is <code>std::basic_string&lt;char16_t></code>, <code>std::u32string</code> which is <code>std::basic_string&lt;char32_t></code> and <code>std::wstring</code> which is <code>std::basic_string&lt;wchar_t></code> but don&rsquo;t let that fool you because there is also <code>char8_t</code> from C++ 20 that introduces <code>std::u8string</code> and don&rsquo;t forget that <code>wchar_t</code> has different sizes depending on the platform, compiler and time of day.</p><p>C++ is a fucking mess. Working with strings in C++ should not be this hard.</p><p>So lets calm down and look at something different: Rust. I love Rust, it&rsquo;s C++ in way better and more modern. I wanted to rework rpgmpacker in Rust and actually did exactly that for quite some time but soon realized this was also not the way.</p><p>RPG Maker MV/MZ is pure JavaScript with the data files being in JSON. The developers are probably familiar with JavaScript as well so in this ecosystem it is more fitting to create a JavaScript tool. Of course I wouldn&rsquo;t be doing that, fuck vanilla JavaScript, I&rsquo;m using TypeScript.</p><p>I like to use the right tool for the job. Even though I&rsquo;m quite the C# fanatic I went with TypeScript because it makes life very easy. I don&rsquo;t have to write complex JSON parsers or DTOs, I can just do <code>JSON.parse(...)</code> and access whatever I want. One huge problem was also parsing the plugins for the exclude-unused feature. If you open <code>js/plugins.js</code> in your game, you will find a variable <code>$plugins</code>. With TypeScript I can just use the VM to dynamically load this file and access this variable directly. With any other language I would have to read the file as a string and do some complex string parsing.</p><p>Of course there are some problems with TypeScript. I previously complained about the C++ dependency systems but the huge dependency trees you can get when using NPM are also insane. Before I even started on the rework I set my goal to require the least amount of modules which ended up being only 1: <a href=https://www.npmjs.com/package/yargs>yargs</a> because parsing arguments is not something I wanna implement myself.</p><p>I hope the rework will be received pleasantly by the 3 people using the tool.</p></div></div></article><div class=pagination><div class=pagination__title><span class=pagination__title-h></span><hr></div><div class=pagination__buttons><span class="button previous"><a href=https://erri120.github.io/posts/2021-12-10/><span class=button__icon>←</span>
<span class=button__text>Fixing Anno 2070 by changing three bytes</span></a></span>
<span class="button next"><a href=https://erri120.github.io/posts/2021-09-29/><span class=button__text>Don't count frames to calculate time</span>
<span class=button__icon>→</span></a></span></div></div><hr><div style=margin-top:16px;margin-bottom:8px;display:flex;justify-content:center><script type=text/javascript src=https://storage.ko-fi.com/cdn/widget/Widget_2.js></script><script type=text/javascript>kofiwidget2.init("Support Me on Ko-fi","#29abe0","P5P03UIPI"),kofiwidget2.draw()</script></div><script src=https://utteranc.es/client.js repo=erri120/erri120.github.io issue-term=pathname label=site-comment theme=github-dark-orange crossorigin=anonymous async></script></main></div><footer class=footer><div class=footer__inner><div class="copyright copyright--user"><span>CC BY 4.0</span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a> and modified by me</span></div></div></footer><script src=https://erri120.github.io/assets/main.js></script>
<script src=https://erri120.github.io/assets/prism.js></script></div></body></html>